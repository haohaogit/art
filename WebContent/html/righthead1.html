<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8"></meta>
    <script type="text/javascript" src="../js/jquery-1.8.2.min.js"></script>
    <title></title>
   
</head>
<body>
	<script type="text/javascript">
	        $(document).ready(function () {
	        	//alert("99990");
	        	$.ajax("checkLogin",
	    				// 发送请求的URL字符串
	    				{
	    					dataType : "json", //
	    					type: "post",      //
	    					contentType: "application/json",  //
	    					//data: JSON.stringify({uname:name,upassword:password}),
	    					async:true,  //
	    					success: function(data){
	    						if(data.isLogin){
	    							$("#username").css({display:'block'});
		    						$(".loginSucc").css({display:'none'});
		    						$("#p1").html(data.username);
	    						}else{
	    							//alert("notlogin");
	    						}
	    						//alert("数据发送成功denglu");
	    					},
	    					error: function(){
	    						alert("数据发送失败denglu");
	    					}
	    				});
	        });
	</script>
	
    <div>
       <div id="operator">
            <div id="username">
                <span id="p1"></span>
            </div>
            <div id="login" class="loginSucc">
                <a href="javascript:void(0)" id="loginBtn"><img
                    src="../image/login.png"></a>
            </div>
            <div id="register" class="loginSucc">
                <a href="javascript:void(0)" id="registerBtn"><img
                    src="../image/register.png"></a>
            </div>
        </div>
        <div id="search_C" style="width: 260px;">
            <!--<img src="images/首页/search.png">-->
            <input id="input" type="text" style="height: 28px;width: 217px" name="search" placeholder="外观库搜索" />
            <div id="search_icon">
                <img id="Isearch" src="../image/search_icon.png">
            </div>
        </div>
    </div>

    <div id="LoginBox">
<!--        <form action="customerLogin" method="post" -->
<!--            onSubmit="return loginCheck()"> -->
            
            <div class="rowTitle">
                意象造型映射<a href="javascript:void(0)" title="关闭窗口" class="close_btn"
                    id="closeBtn">×</a>
            </div>
            <div class="row">
                <span>账号</span> <br>
                <div class="inputBox">
                    <input type="text" class="txt" id="account" name="account"
                        placeholder="账号" />
                </div>
            </div>
            <div class="row">
                <span>密码</span><br>
                <div class="inputBox">
                    <input type="password" class="txt" id="password" name="password"
                        placeholder="密码" />
                </div>
            </div>
            <div class="row">
                <button type="submit" id="loginbtn">登录</button>
            </div>
            
<!--        </form> -->
        <div id="loginHint">
            还没有账号？<a href="javascript:void(0)" id="turnToRegister">注册</a>
        </div>
        <script type="text/javascript">
            $("#turnToRegister").on('click', function() {
                $("#LoginBox").fadeOut(0);
                $("#RegisterBox").fadeIn(0);
            })
        </script>
    </div>
    <script type="text/javascript">
        $(function($) {
            //弹出登录
            $("#loginBtn").hover(function() {
                $(this).stop().animate({
                    opacity : '1'
                }, 600);
            }, function() {
                $(this).stop().animate({
                    opacity : '0.6'
                }, 1000);
            }).on('click', function() {
                $("body").append("<div id='mask'></div>");
                $("#mask").addClass("mask").fadeIn("slow");
                $("#LoginBox").fadeIn("slow");
            });
            //
            //按钮的透明度
            $("#loginbtn").hover(function() {
                $(this).stop().animate({
                    opacity : '1'
                }, 600);
            }, function() {
                $(this).stop().animate({
                    opacity : '0.8'
                }, 1000);
            });
            //关闭
            $(".close_btn").hover(function() {
                $(this).css({
                    color : 'black'
                })
            }, function() {
                $(this).css({
                    color : '#51A3BB'
                })
            }).on('click', function() {
                $("#LoginBox").fadeOut("fast");
                $("#mask").css({
                    display : 'none'
                });
            });
        });
        
        $("#loginbtn").on('click',function(){
            
            sendLoginContent($("#account").val(),$("#password").val());
        })
        function sendLoginContent(name,password){
            alert(name+" 999 "+password);

//             /* $("#USERNAME").CSS({DISPLAY:'BLOCK'});
//             $(".LOGINSUCC").CSS({DISPLAY:'NONE'});
//             $("#P1").HTML("HAOHAO");
//             // $("#LOGIN").FADEOUT("FAST");
//             // $("#REGISTER").FADEOUT("FAST");
//             $("#LOGINBOX").FADEOUT("FAST");
            
//             $("#MASK").CSS({
//                 DISPLAY : 'NONE'
//             });
//             ALERT("数据发送成功DENGLU"); */



            $.ajax("customerLogin",
    				// 发送请求的URL字符串
    				{
    					dataType : "json", //
    					type: "post",      //
    					contentType: "application/json",  //
    					data: JSON.stringify({uname:name,upassword:password}),
    					async:true,  //
    					success: function(data){
    						$("#username").css({display:'block'});
    						$(".loginSucc").css({display:'none'});
    						
    						$("#p1").html(data.uname);
    						
    						
    						$("#LoginBox").fadeOut("fast");
    						
    						$("#mask").css({
    							display : 'none'
    						});
    						alert("数据发送成功denglu");
    					},
    					error: function(){
    						alert("数据发送失败denglu");
    					}
    				});
        }
        
        
    </script>
    <script type="text/javascript">
        function registerCheck() {
            var newAccount = document.getElementById("newAccount");
            var newPassword = document.getElementById("newPassword");
            if (newAccount.value == "") {
                alert("请输入账号");
                return false;
            } else if (newPassword.value == "") {
                alert("请输入密码");
                return false;
            }
        }
    </script>
    <div id="RegisterBox">
<!--        <form action="customerRegister.do" method="post" -->
<!--            onSubmit="return registerCheck()"> -->
            <div class="rowTitle">
                意象造型映射<a href="javascript:void(0)" title="关闭窗口" class="close_btn"
                    id="closeBtn">×</a>
            </div>
            <div class="row">
                用户号:
                <div class="inputBox">
                    <input type="text" class="txt" id="newAccount" name="newAccount"
                        placeholder="用户名不超过16位字符" />
                </div>
            </div>
            <div class="row">
                <span>邮箱:</span>
                <div class="inputBox">
                    <input type="text" class="txt" id="newEmail"
                        name="newEmail" placeholder="输入邮箱" />
                </div>
            </div>
            <div class="row">
                <span>密码:</span>
                <div class="inputBox">
                    <input type="password" class="txt" id="newPassword"
                        name="newPassword" placeholder="密码" />
                </div>
            </div>
            <div class="row">
                <span>确认密码:</span>
                <div class="inputBox">
                    <input type="password" class="txt" id="ConfPassword"
                        name="ConfPassword" placeholder="确认密码" />
                </div>
            </div>
            <div class="row">
                <button type="submit" id="registerbtn">注册</button>
            </div>
<!--        </form> -->
        <div id="registerHint">
            注册成功，请<a href="javascript:void(0)" id="turnToLogin">登录</a>
        </div>
        <script type="text/javascript">
            $("#turnToLogin").on('click', function() {
                $("#RegisterBox").fadeOut(0);
                $("#LoginBox").fadeIn(0);
            })
        </script>
    </div>
    <script type="text/javascript">
        $(function($) {
            //弹出注册
            $("#registerBtn").hover(function() {
                $(this).stop().animate({
                    opacity : '1'
                }, 600);
            }, function() {
                $(this).stop().animate({
                    opacity : '0.6'
                }, 1000);
            }).on('click', function() {
                $("body").append("<div id='mask'></div>");
                $("#mask").addClass("mask").fadeIn("slow");
                $("#RegisterBox").fadeIn("slow");
            });
            //
            //按钮的透明度
            $("#registerbtn").hover(function() {
                $(this).stop().animate({
                    opacity : '1'
                }, 600);
            }, function() {
                $(this).stop().animate({
                    opacity : '0.8'
                }, 1000);
            });
            //关闭
            $(".close_btn").hover(function() {
                $(this).css({
                    color : 'black'
                })
            }, function() {
                $(this).css({
                    color : '#51A3BB'
                })
            }).on('click', function() {
                $("#RegisterBox").fadeOut("fast");
                $("#mask").css({
                    display : 'none'
                });
            });
        });
        
        $("#registerbtn").on('click',function(){
            
            sendregisterContent($("#newAccount").val(),$("#newEmail").val(),$("#newPassword").val(),$("#ConfPassword").val());
        })
        function sendregisterContent(name,email,password,cpassword){
            alert(name+password);
//          $.ajax("${pageContext.request.contextPath}/search/facade",
            $.ajax("customerRegister",
                // 发送请求的URL字符串
                {
                    dataType : "json", //
                    type: "post",      //
                    contentType: "application/json",  //
                    data: JSON.stringify({uname:name,uemail:email,upassword:password,cpassword:cpassword}),
                    async:true,  //
                    success: function(data){
                        $("#p1").html(data.uname);
                        $("#login").fadeOut("fast");
                        $("#register").fadeOut("fast");
                        $("#RegisterBox").fadeOut("fast");
                        
                        $("#mask").css({
                            display : 'none'
                        });
                        alert("数据发送成功denglu");
                    },
                    error: function(){
                        alert("数据发送失败denglu");
                    }
                });
        }


        function loginCheck() {
            var account = document.getElementById("account");
            var password = document.getElementById("password");
            if (account.value == "") {
                alert("请输入账号");
                return false;
            } else if (password.value == "") {
                alert("请输入密码");
                return false;
            }
        }
        $("#search_icon").on('click',function(){
            alert($("#input").val());
            
            window.location.href="main-search.html?txt="+$("#input").val();
            //sendLoginContent($("#account").val(),$("#password").val());
        })
        
       	$("#input").bind("keydown",function(e){
        	var theEvent = e || window.event;    
        	var code = theEvent.keyCode || theEvent.which || theEvent.charCode;
        	 if (code == 13) {    
   	       		 //回车执行查询
        		 if(this.value != ''){
 					//alert("foxfire");
 					window.location.href="main-search.html?txt="+$("#input").val();
 				}
   	        }    
		})
    </script>

</body>

</html>
